import system.dl as DL

extern ffi.simple_add_i32 : i32 (a : i32, b : i32)

lib :: i64 = DL.Open("Tests/ffi/libsimpleffi.so", ffi)

AddViaGlobal : i32 (a : i32, b : i32) {
  return lib.simple_add_i32(a, b)
}

main : i32 () {
  if (lib == 0) {
    return 0
  }
  out : i32 = AddViaGlobal(20, 22)
  DL.Close(lib)
  if (out == 42) {
    return 1
  }
  return 0
}
